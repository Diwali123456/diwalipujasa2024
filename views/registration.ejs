<!-- registration.ejs -->

<%- include("partials/header"); -%>
    <header class="masthead" style="background-image: url('/assets/img/maa_charan.webp')">
        <div class="container position-relative px-4 px-lg-5">
            <div class="row gx-4 gx-lg-5 justify-content-center">
                <div class="col-md-10 col-lg-8 col-xl-7">
                    <div class="site-heading">
                        <h1>Registration</h1>
                        <!-- <span class="subheading">Let's jot something down today...</span> -->
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="mb-4">
        <div class="container px-4 px-lg-5">
            <div class="row gx-4 gx-lg-6 justify-content-center">
                <div class="col-md-12 col-lg-12 col-xl-10">
                    <p class="text-center mt-0 mb-2 fw-bold">🪷 Jai Shri Mataji! 🪷</p>
                    <h3 class="text-center">REGISTRATION INFORMATION</h3>
                    <p class="fw-bold">FOR YOGIS/YOGINIS</p>
                    <table class="table">
                        <thead>
                            <tr>
                                <th scope="col">CATEGORY</th>
                                <th scope="col">Developing Countries International</th>
                                <th scope="col">Developed Countries International</th>
                               <!-- <th scope="col">South Africa</th>-->
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Adults (26+)</td>
                                <td>€ 280.00/-</td>
                                <td>€ 350.00/-</td>
                               <!-- <td>R 3800.00</td>-->
                            </tr>
                            <tr>
                                <td>Yuvas (18-26)</td>
                                <td>€ 260.00/-</td>
                                <td>€ 270.00/-</td>
                                <!--<td>R 3800.00</td>-->
                            </tr>
                            <tr>
                                <td>Balshaktis</td>
                                <td>€ 200.00/-</td>
                                <td>€ 210.00/-</td>
                                <!--<td>R 2850.00</td>-->
                            </tr>
                            <tr>
                                <td>0-6 Years</td>
                                <td>Free</td>
                                <td>Free</td>
                                <!--<td>Free</td>-->
                            </tr>
                        </tbody>
                    </table>
                   <!-- <p class="fw-bold mb-2">FOR FOREIGN YOGIS/YOGINIS</p>-->
                   <!-- <p class="mb-0 mt-0">CATEGORY: All | CONTRIBUTION: Contribution will be different as per fees chart</p>-->
                    <hr>
                    <form action="/registration" method="post">
                        <div class="form-group">
                            <label for="registrationDuration">Select Registration For Developing or Developed
                                Countries International:</label>
                            <select class="form-control" name="registrationDuration" id="registrationDuration" required>
                                <option value="threedaysseminar">Developing Countries International</option>
                                <option value="onedaypuja">Developed Countries International</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="registrationType">Select below Registration for Local South African Yogies:</label>
                            <select class="form-control" name="registrationType" id="registrationType" required>
                                <option value="indian"> Developing or Developed
                                    Countries International Yogies</option>
                                <option value="foreigner">Local South African Yogies</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="numAdults" class="">Number of Adults:</label>
                            <input class="col-md-2" type="number" class="form-control" name="numAdults" id="numAdults"
                                value="<%= numAdults %>" min="0">
                        </div>

                        <!-- Adult Details -->
                        <div id="adultDetails">
                            <!-- Rows for adults will be added here dynamically -->
                        </div>

                        <!-- Number of Yuvas -->
                        <div class="form-group">
                            <label for="numYuvas">Number of Yuvas:</label>
                            <input class="col-md-2" type="number" class="form-control" name="numYuvas" id="numYuvas"
                                value="<%= numYuvas %>" min="0">
                        </div>

                        <!-- Yuva Details -->
                        <div id="yuvaDetails">
                            <!-- Rows for yuvas will be added here dynamically -->
                        </div>

                        <!-- Number of Children -->
                        <div class="form-group">
                            <label for="numBals">Number of Balshaktis:</label>
                            <input class="col-md-2" type="number" class="form-control" name="numBals" id="numBals"
                                value="<%= numBals %>" min="0">
                        </div>

                        <!-- Child Details -->
                        <div id="balDetails">
                            <!-- Rows for children will be added here dynamically -->
                        </div>

                        <hr>
                        <h3>Payer's Details</h3>
                        <!-- Payer's Details -->
                        <div id="payerDetails" class="form-row">
                            <div class="form-group col-md-4">
                                <label for="payerFirstName">Name:<span class="text-danger fw-bold">*</span></label>
                                <input type="text" class="form-control" name="payerFirstName" id="payerFirstName"
                                    required>
                            </div>
                            <div class="form-group col-md-4">
                                <label for="payerEmail">Email:</label>
                                <input type="text" class="form-control" name="payerEmail" id="payerEmail">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="payerMobile">Mobile No.:<span class="text-danger fw-bold">*</span></label>
                                <input type="text" class="form-control" name="payerMobile" id="payerMobile"
                                    pattern="\d{10}" maxlength="10" required>
                            </div>
                            <div class="form-group col-md-4">
                                <label for="payerDistrict">District:<span class="text-danger fw-bold">*</span></label>
                                <input type="text" class="form-control" name="payerDistrict" id="payerDistrict"
                                    required>
                            </div>
                            <% const indianStates=["Afghanistan",
                            "Albania",
                            "Algeria",
                            "American Samoa",
                            "Andorra",
                            "Angola",
                            "Anguilla",
                            "Antarctica",
                            "Antigua and Barbuda",
                            "Argentina",
                            "Armenia",
                            "Aruba",
                            "Australia",
                            "Austria",
                            "Azerbaijan",
                            "Bahamas (the)",
                            "Bahrain",
                            "Bangladesh",
                            "Barbados",
                            "Belarus",
                            "Belgium",
                            "Belize",
                            "Benin",
                            "Bermuda",
                            "Bhutan",
                            "Bolivia (Plurinational State of)",
                            "Bonaire, Sint Eustatius and Saba",
                            "Bosnia and Herzegovina",
                            "Botswana",
                            "Bouvet Island",
                            "Brazil",
                            "British Indian Ocean Territory (the)",
                            "Brunei Darussalam",
                            "Bulgaria",
                            "Burkina Faso",
                            "Burundi",
                            "Cabo Verde",
                            "Cambodia",
                            "Cameroon",
                            "Canada",
                            "Cayman Islands (the)",
                            "Central African Republic (the)",
                            "Chad",
                            "Chile",
                            "China",
                            "Christmas Island",
                            "Cocos (Keeling) Islands (the)",
                            "Colombia",
                            "Comoros (the)",
                            "Congo (the Democratic Republic of the)",
                            "Congo (the)",
                            "Cook Islands (the)",
                            "Costa Rica",
                            "Croatia",
                            "Cuba",
                            "Curaçao",
                            "Cyprus",
                            "Czechia",
                            "Côte d'Ivoire",
                            "Denmark",
                            "Djibouti",
                            "Dominica",
                            "Dominican Republic (the)",
                            "Ecuador",
                            "Egypt",
                            "El Salvador",
                            "Equatorial Guinea",
                            "Eritrea",
                            "Estonia",
                            "Eswatini",
                            "Ethiopia",
                            "Falkland Islands (the) [Malvinas]",
                            "Faroe Islands (the)",
                            "Fiji",
                            "Finland",
                            "France",
                            "French Guiana",
                            "French Polynesia",
                            "French Southern Territories (the)",
                            "Gabon",
                            "Gambia (the)",
                            "Georgia",
                            "Germany",
                            "Ghana",
                            "Gibraltar",
                            "Greece",
                            "Greenland",
                            "Grenada",
                            "Guadeloupe",
                            "Guam",
                            "Guatemala",
                            "Guernsey",
                            "Guinea",
                            "Guinea-Bissau",
                            "Guyana",
                            "Haiti",
                            "Heard Island and McDonald Islands",
                            "Holy See (the)",
                            "Honduras",
                            "Hong Kong",
                            "Hungary",
                            "Iceland",
                            "India",
                            "Indonesia",
                            "Iran (Islamic Republic of)",
                            "Iraq",
                            "Ireland",
                            "Isle of Man",
                            "Israel",
                            "Italy",
                            "Jamaica",
                            "Japan",
                            "Jersey",
                            "Jordan",
                            "Kazakhstan",
                            "Kenya",
                            "Kiribati",
                            "Korea (the Democratic People's Republic of)",
                            "Korea (the Republic of)",
                            "Kuwait",
                            "Kyrgyzstan",
                            "Lao People's Democratic Republic (the)",
                            "Latvia",
                            "Lebanon",
                            "Lesotho",
                            "Liberia",
                            "Libya",
                            "Liechtenstein",
                            "Lithuania",
                            "Luxembourg",
                            "Macao",
                            "Madagascar",
                            "Malawi",
                            "Malaysia",
                            "Maldives",
                            "Mali",
                            "Malta",
                            "Marshall Islands (the)",
                            "Martinique",
                            "Mauritania",
                            "Mauritius",
                            "Mayotte",
                            "Mexico",
                            "Micronesia (Federated States of)",
                            "Moldova (the Republic of)",
                            "Monaco",
                            "Mongolia",
                            "Montenegro",
                            "Montserrat",
                            "Morocco",
                            "Mozambique",
                            "Myanmar",
                            "Namibia",
                            "Nauru",
                            "Nepal",
                            "Netherlands (the)",
                            "New Caledonia",
                            "New Zealand",
                            "Nicaragua",
                            "Niger (the)",
                            "Nigeria",
                            "Niue",
                            "Norfolk Island",
                            "Northern Mariana Islands (the)",
                            "Norway",
                            "Oman",
                            "Pakistan",
                            "Palau",
                            "Palestine, State of",
                            "Panama",
                            "Papua New Guinea",
                            "Paraguay",
                            "Peru",
                            "Philippines (the)",
                            "Pitcairn",
                            "Poland",
                            "Portugal",
                            "Puerto Rico",
                            "Qatar",
                            "Republic of North Macedonia",
                            "Romania",
                            "Russian Federation (the)",
                            "Rwanda",
                            "Réunion",
                            "Saint Barthélemy",
                            "Saint Helena, Ascension and Tristan da Cunha",
                            "Saint Kitts and Nevis",
                            "Saint Lucia",
                            "Saint Martin (French part)",
                            "Saint Pierre and Miquelon",
                            "Saint Vincent and the Grenadines",
                            "Samoa",
                            "San Marino",
                            "Sao Tome and Principe",
                            "Saudi Arabia",
                            "Senegal",
                            "Serbia",
                            "Seychelles",
                            "Sierra Leone",
                            "Singapore",
                            "Sint Maarten (Dutch part)",
                            "Slovakia",
                            "Slovenia",
                            "Solomon Islands",
                            "Somalia",
                            "South Africa",
                            "South Georgia and the South Sandwich Islands",
                            "South Sudan",
                            "Spain",
                            "Sri Lanka",
                            "Sudan (the)",
                            "Suriname",
                            "Svalbard and Jan Mayen",
                            "Sweden",
                            "Switzerland",
                            "Syrian Arab Republic",
                            "Taiwan",
                            "Tajikistan",
                            "Tanzania, United Republic of",
                            "Thailand",
                            "Timor-Leste",
                            "Togo",
                            "Tokelau",
                            "Tonga",
                            "Trinidad and Tobago",
                            "Tunisia",
                            "Turkey",
                            "Turkmenistan",
                            "Turks and Caicos Islands (the)",
                            "Tuvalu",
                            "Uganda",
                            "Ukraine",
                            "United Arab Emirates (the)",
                            "United Kingdom of Great Britain and Northern Ireland (the)",
                            "United States Minor Outlying Islands (the)",
                            "United States of America (the)",
                            "Uruguay",
                            "Uzbekistan",
                            "Vanuatu",
                            "Venezuela (Bolivarian Republic of)",
                            "Viet Nam",
                            "Virgin Islands (British)",
                            "Virgin Islands (U.S.)",
                            "Wallis and Futuna",
                            "Western Sahara",
                            "Yemen",
                            "Zambia",
                            "Zimbabwe",
                            "Åland Islands" ]; %>

                                <div class="form-group col-md-4">
                                    <label for="payerState">Countries:<span class="text-danger fw-bold">*</span></label>
                                    <select class="form-control" name="payerState" id="payerState" required>
                                        <option value="" disabled selected>Select Countries</option>
                                        <% indianStates.forEach(state=> { %>
                                            <option value="<%= state %>">
                                                <%= state %>
                                            </option>
                                            <% }); %>
                                    </select>
                                </div>
                                <div class="form-group col-md-4">
                                    <label for="payerPAN">PASSPORT:<span class="text-danger fw-bold">*</span></label>
                                    <input type="text" class="form-control" name="payerPAN" id="payerPAN" required>
                                </div>
                                <!-- <div class="form-group col-md-4">
                            <label for="payerAADHAAR">AADHAAR No.:</label>
                            <input type="text" class="form-control" name="payerAADHAAR" id="payerAADHAAR" required>
                        </div> -->
                        </div>

                        <p id="totalAmount" class="fw-bold fs-3 mt-2 mb-0"></p>
                        <input type="hidden" name="totalAmount" id="totalAmountInput" value="<%= totalAmount %>">
                        <p class="mt-2">
                        <p style="color:Red">Note: If You have selected Registration for Local South Africa Pay in Rand</p>
                        <a href="https://www.xe.com/currencyconverter/convert/?Amount=1&From=EUR&To=INR"
                            target="_blank">
                            Convert EUR to your currency
                        </a>
                        </p>
                        <hr>
                        <!-- Section for Seminar Dedication Amount -->
                        <div class="mt-3 mb-2">
                            <h3 class="text-center">Payment Methods</h3>
                            <!--<p class="mt-2 fs-5 text-success fw-bold mb-2">Please make the payment using either of the
                                two available methods.</p>
                            <p class="mt-2 fs-5 text-success hindi fw-bold mb-2">कृपया उपलब्ध दो तरीकों में से किसी एक
                                का उपयोग करके भुगतान करें।</p>
                            <p class="text-center mb-2 mt-0">══━━━━✥◈✥━━━━══</p>
                            <h3 class="text-center">1️⃣ QR Code</h3>
                            <img class="col-md-6 rounded mx-auto d-block" src="/assets/img/qr.png">
                            <hr>
                            <style>
                                textarea {
                                  width: calc(100% - 40px);
                                  height: 50px;
                                  margin-bottom: 10px;
                                  padding: 10px;
                                  border: 3px solid #a67bda;
                                  border-radius: 4px;
                                  resize: none;
                                }
                            
                                button {
                                  padding: 10px 20px;
                                  background-color: #1f6221;
                                  color: white;
                                  border: none;
                                  border-radius: 4px;
                                  cursor: pointer;
                                }
                            
                                button:hover {
                                  background-color: #45a049;
                                }
                              </style>
                            <textarea id="textToCopy" rows="1" cols="25">mab.037244001020210@axisbank</textarea>
                            <button onclick="copyText()">Copy UPI ID</button>
                            <script>
                                function copyText() {
                                  var textToCopy = document.getElementById('textToCopy');
                                  textToCopy.select();
                                  document.execCommand('copy');
                                  alert('Text copied!');
                                }
                            </script>-->

                            <h3 class="text-center mt-3 mb-0">1️⃣ Bank Details</h3>
                            <p class="fw-bold mb-0">A/C Name: Sahaja Yoga International - Durban
                                <br>
                                Bank: First National Bank<br>
                                Account Number : 63100138692 <br>
                                Branch Code : 255355<br>
                                Branch Name : My Branch<br>
                                Account Type : Current Account - Gold Business<br>
                                Swift Code : FIRNZAJJ <br>
                                Reference : Diw 24 CT and Your Name<br>
                            </p>
                            <p>NB: If you are making a Donation payment use Reference: Diw 24 Don and Your Name.</p>
                            <p>Email payment confirmation: diwalipujasa2024@gmail.com</p>
                            <!-- <p>The amount can be transferred through RTGS and NEFT. Please insert UTR Number after payment, to complete the registration process.</p>
                                <p>आरटीजीएस और एनईएफटी के माध्यम से राशि स्थानांतरित की जा सकती है। पंजीकरण प्रक्रिया को पूरा करने के लिए कृपया भुगतान के बाद UTR नंबर डालें।</p> -->
                            <!-- <p >🔴NOTE: - Take screenshot after the payment is complete.</p>
                                    <p>🔴नोट: - भुगतान पूरा होने के बाद स्क्रीनशॉट लें।</p> -->
                            <p class=" mt-0 text-center">══━━━━✥◈✥━━━━══</p>
                        </div>

                       <!-- <div class="form-group">
                            <label for="utrNumber" class="fw-bold">UTR Number/UPI Transaction ID/Cash:<span
                                    class="text-danger fw-bold">*</span></label>
                            <input type="text" class="form-control" name="utrNumber" id="utrNumber" required>
                            <p class="mt-0 mb-3 fs-6">(In case of <span class="fw-bold">multiple numbers</span>, use
                                <span class="fw-bolder hindi">' , '</span> to separate them.<br>For example: <span
                                    class="fw-bold">573647863481, T3678478582834, Paid to person name</span>
                                )
                            </p>-->
                            <!-- <p class="mt-0 mb-2 hindi fs-6">(यदि कई संख्याएँ हैं, तो उन्हें <span class="fw-bold">' ,
                                    '</span> से अलग करें।<br>उदाहरण के लिए: <span class="fw-bold">573647863481,
                                    T3678478582834, Paid to person name</span> )</p>-->
                        </div>
                        <hr>
                        <h3 class="text-center">Transportation Facility</h3>
                        <p class="text-justify mt-0 mb-2 fs-6 #ffff" style="color:darkred;">In case if you require
                            transportation facility from <span class="fw-bold">Cape Town International Airport to Puja
                                Venue</span>, please inform us of your arrival.</p>
                        <!-- <p class="text-justify mt-0 hindi fs-6">
                            अगर आप <span class="fw-bold">बेंगलुरु से पूजा स्थल के लिए</span> के लिए परिवहन सुविधा का
                            उपयोग करना चाहते हैं तो कृपया अपने आगमन की जानकारी हमें प्रदान करें।</p>-->
                        <!-- Arrival Date and Time -->
                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label for="arrivalDate" class="fw-bold">Arrival Date:</label>
                                <input type="date" class="form-control" name="arrivalDate" id="arrivalDate">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="arrivalTime" class="fw-bold">Arrival Time:</label>
                                <input type="time" class="form-control" name="arrivalTime" id="arrivalTime">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="arrivalLocation" class="fw-bold">Arrival Location:</label>
                                <select class="form-control" name="arrivalLocation" id="arrivalLocation">
                                    <option value="" disabled selected>Select Arrival Location</option>
                                    <option value="Cape Town International Airpor">Cape Town International Airport
                                    </option>
                                </select>
                            </div>
                        </div>

                        <!-- <h3 class="fw-bold fs-5 text-center text-success mb-3">Please bring a print out of the transaction as a payment proof!</h3> -->
                        <button type="submit"
                            class="btn btn-success custom-btn  rounded mx-auto d-block">Submit</button>
                    </form>
                </div>
            </div>
        </div>
    </main>

    <!-- Include jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

    <script>
        $(document).ready(function () {
            function addRows(category, count) {
                for (let i = 1; i <= count; i++) {
                    let rowHtml = `
                    <div class="form-row">
                        <div class="form-group col-md-2.4">
                            <label for="${category}Name${i}">${category.charAt(0).toUpperCase() + category.slice(1)} ${i} Name:<span class="text-danger fw-bold">*</span></label>
                            <input type="text" class="form-control" name="${category}Name${i}" id="${category}Name${i}" required>
                        </div>

                        <div class="form-group col-md-2.4">
                            <label for="${category}Address${i}">Address:<span class="text-danger fw-bold">*</span></label>
                            <input type="text" class="form-control" name="${category}Address${i}" id="${category}Address${i}" required>
                        </div>

                        <div class="form-group col-md-2.4">
                            <label for="${category}Gender${i}">Gender:<span class="text-danger fw-bold">*</span></label>
                            <select class="form-control" name="${category}Gender${i}" id="${category}Gender${i}" required>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <!-- Add other gender options as needed -->
                            </select>
                        </div>
                        <div class="form-group col-md-2.4">
                            <label for="${category}Age${i}">Age:<span class="text-danger fw-bold">*</span></label>
                            <input type="number" class="form-control" name="${category}Age${i}" id="${category}Age${i}" required>
                        </div>
                        <!--<div class="form-group col-md-2.4">
                            <label for="${category}Staying${i}">Staying At Venue:<span class="text-danger fw-bold">*</span></label>
                            <select class="form-control" name="${category}Staying${i}" id="${category}Staying${i}" required>
                                <option value="yes">Yes</option>
                                <option value="no">No</option>
                                <!-- Add other gender options as needed
                            </select>-->
                        </div>
                    </div>
                `;
                    $(`#${category}Details`).append(rowHtml);
                }
            }

            $("#numAdults").on("change", function () {
                const count = parseInt($(this).val(), 10);
                $("#adultDetails").empty();
                addRows("adult", count);
            });

            $("#numYuvas").on("change", function () {
                const count = parseInt($(this).val(), 10);
                $("#yuvaDetails").empty();
                addRows("yuva", count);
            });

            $("#numBals").on("change", function () {
                const count = parseInt($(this).val(), 10);
                $("#balDetails").empty();
                addRows("bal", count);
            });

            function calculateTotalAmount() {
                const nonForeignerPrices = {
                    adult: 280,
                    yuva: 260,
                    bal: 200
                };

                const filledPrices = {
                    adult: 2450,
                    yuva: 1850,
                    bal: 950
                };

                const foreignerPrices = {
                    adult: 3800,
                    yuva: 3800,
                    bal: 2850
                };

                const oneDayPujaPrices = {
                    adult: 350,
                    yuva: 270,
                    bal: 210
                };

                const registrationType = $("#registrationType").val();
                const registrationDuration = $("#registrationDuration").val();
                let prices;

                if (registrationDuration === "filledPrice") {
                    prices = filledPrices;
                } else if (registrationDuration === "threedaysseminar") {
                    if (registrationType === "foreigner") {
                        prices = foreignerPrices;
                    } else {
                        prices = nonForeignerPrices;
                    }
                } else {
                    if (registrationType === "foreigner") {
                        prices = foreignerPrices;
                    } else {
                        prices = oneDayPujaPrices;
                    }
                }

                const numAdults = parseInt($("#numAdults").val(), 10) || 0;
                const numYuvas = parseInt($("#numYuvas").val(), 10) || 0;
                const numBals = parseInt($("#numBals").val(), 10) || 0;

                // Calculate total amount
                const totalAmount = (numAdults * prices.adult) + (numYuvas * prices.yuva) + (numBals * prices.bal);

                // Display total amount in the form or update the UI as needed
                $("#totalAmount").text(`Total Amount to be paid: €${totalAmount} `);

                // Set the value of the hidden input
                $("#totalAmountInput").val(totalAmount);

                // Enable or disable the submit button based on totalAmount
                $("button[type='submit']").prop("disabled", !(totalAmount > 0));
            }

            // Disable submit button on page load
            $("button[type='submit']").prop("disabled", true);

            calculateTotalAmount();

            // Add event listeners for number inputs
            $("#numAdults, #numYuvas, #numBals, #registrationType, #registrationDuration").on("change", calculateTotalAmount);

        });
    </script>
    <%- include("partials/footer"); -%>